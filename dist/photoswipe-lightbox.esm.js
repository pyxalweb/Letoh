/*!
  * PhotoSwipe Lightbox 5.1.7 - https://photoswipe.com
  * (c) 2021 Dmitry Semenov
  */
function createElement(t,e,i){const s=document.createElement(e||"div");return t&&(s.className=t),i&&i.appendChild(s),s}function setWidthHeight(t,e,i){t.style.width="number"==typeof e?e+"px":e,t.style.height="number"==typeof i?i+"px":i}const LOAD_STATE={IDLE:"idle",LOADING:"loading",LOADED:"loaded",ERROR:"error"};function specialKeyUsed(t){if(2===t.which||t.ctrlKey||t.metaKey||t.altKey||t.shiftKey)return!0}function getElementsFromOption(t,e,i=document){let s=[];if(t instanceof Element)s=[t];else if(t instanceof NodeList||Array.isArray(t))s=Array.from(t);else{const n="string"==typeof t?t:e;n&&(s=Array.from(i.querySelectorAll(n)))}return s}function dynamicImportModule(t){return"string"==typeof t?import(t):t}class PhotoSwipeEvent{constructor(t,e){this.type=t,e&&Object.assign(this,e)}preventDefault(){this.defaultPrevented=!0}}class Eventable{constructor(){this._listeners={},this._filters={}}addFilter(t,e,i=100){this._filters[t]||(this._filters[t]=[]),this._filters[t].push({fn:e,priority:i}),this._filters[t].sort((t,e)=>t.priority-e.priority),this.pswp&&this.pswp.addFilter(t,e,i)}removeFilter(t,e){this._filters[t]&&(this._filters[t]=this._filters[t].filter(t=>t.fn!==e)),this.pswp&&this.pswp.removeFilter(t,e)}applyFilters(t,...e){return this._filters[t]&&this._filters[t].forEach(t=>{e[0]=t.fn.apply(this,e)}),e[0]}on(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),this.pswp&&this.pswp.on(t,e)}off(t,e){this._listeners[t]&&(this._listeners[t]=this._listeners[t].filter(t=>e!==t)),this.pswp&&this.pswp.off(t,e)}dispatch(t,e){if(this.pswp)return this.pswp.dispatch(t,e);const i=new PhotoSwipeEvent(t,e);return this._listeners?(this._listeners[t]&&this._listeners[t].forEach(t=>{t.call(this,i)}),i):i}}class Content{constructor(t,e){this.options=e.options,this.instance=e,this.data=t,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.state=LOAD_STATE.IDLE}setSlide(t){this.slide=t,this.pswp=t.pswp}load(){this.element||(this.element=createElement("pswp__content"),this.element.style.position="absolute",this.element.style.left=0,this.element.style.top=0,this.element.innerHTML=this.data.html||"")}isZoomable(){return!1}usePlaceholder(){return!1}activate(){}deactivate(){}setDisplayedSize(t,e){this.element&&setWidthHeight(this.element,t,e)}onLoaded(){this.state=LOAD_STATE.LOADED,this.slide&&this.pswp.dispatch("loadComplete",{slide:this.slide})}keepPlaceholder(){return this.state===LOAD_STATE.LOADING}onError(){this.state=LOAD_STATE.ERROR,this.slide&&(this.pswp.dispatch("loadComplete",{slide:this.slide,isError:!0}),this.pswp.dispatch("loadError",{slide:this.slide}))}getErrorElement(){return!1}remove(){this.isAttached=!1,this.element&&this.element.parentNode&&this.element.remove()}appendTo(t){this.isAttached=!0,this.element&&!this.element.parentNode&&t.appendChild(this.element)}destroy(){}}class ImageContent extends Content{load(){if(this.element)return;const t=this.data.src;t&&(this.element=createElement("pswp__img","img"),this.data.srcset&&(this.element.srcset=this.data.srcset),this.element.src=t,this.element.alt=this.data.alt||"",this.state=LOAD_STATE.LOADING,this.element.complete?this.onLoaded():(this.element.onload=(()=>{this.onLoaded()}),this.element.onerror=(()=>{this.onError()})))}setDisplayedSize(t,e){const i=this.element;i&&(setWidthHeight(i,t,"auto"),i.srcset&&(!i.dataset.largestUsedSize||t>i.dataset.largestUsedSize)&&(i.sizes=t+"px",i.dataset.largestUsedSize=t),this.slide&&this.pswp.dispatch("imageSizeChange",{slide:this.slide,width:t,height:e}))}isZoomable(){return this.state!==LOAD_STATE.ERROR}usePlaceholder(){return!0}lazyLoad(){this.load()}destroy(){this.element&&(this.element.onload=null,this.element.onerror=null,this.element=null)}appendTo(t){this.isAttached=!0,this.slide&&!this.slide.isActive&&"decode"in this.element?(this.isDecoding=!0,requestAnimationFrame(()=>{this.element&&this.element.decode().then(()=>{this.isDecoding=!1,requestAnimationFrame(()=>{this.appendImageTo(t)})}).catch(()=>{})})):this.appendImageTo(t)}activate(){this.slide&&this.slide.container&&this.isDecoding&&this.appendImageTo(this.slide.container)}getErrorElement(){const t=createElement("pswp__error-msg-container");t.innerHTML=this.options.errorMsg;const e=t.querySelector("a");return e&&(e.href=this.data.src),t}appendImageTo(t){this.element&&!this.element.parentNode&&this.isAttached&&t.appendChild(this.element)}}class PhotoSwipeBase extends Eventable{constructor(){super(),this.contentTypes={image:ImageContent,html:Content}}getNumItems(){let t;const{dataSource:e}=this.options;e?e.length?t=e.length:e.gallery&&(e.items||(e.items=this._getGalleryDOMElements(e.gallery)),e.items&&(t=e.items.length)):t=0;const i=this.dispatch("numItems",{dataSource:e,numItems:t});return this.applyFilters("numItems",i.numItems,e)}addContentType(t,e){this.contentTypes[t]=e}getContentClass(t){return t.type?this.contentTypes[t.type]:t.src?this.contentTypes.image:t.html?this.contentTypes.html:void 0}createContentFromData(t){return new(this.getContentClass(t))(t,this)}getItemData(t){const{dataSource:e}=this.options;let i;Array.isArray(e)?i=e[t]:e&&e.gallery&&(e.items||(e.items=this._getGalleryDOMElements(e.gallery)),i=e.items[t]);let s=i;s instanceof Element&&(s=this._domElementToItemData(s));const n=this.dispatch("itemData",{itemData:s||{},index:t});return this.applyFilters("itemData",n.itemData,t)}_getGalleryDOMElements(t){return this.options.children||this.options.childSelector?getElementsFromOption(this.options.children,this.options.childSelector,t)||[]:[t]}_domElementToItemData(t){const e={element:t},i="A"===t.tagName?t:t.querySelector("a");if(i){e.src=i.dataset.pswpSrc||i.href,e.srcset=i.dataset.pswpSrcset,e.w=parseInt(i.dataset.pswpWidth,10),e.h=parseInt(i.dataset.pswpHeight,10),i.dataset.pswpType&&(e.type=i.dataset.pswpType);const s=t.querySelector("img");s&&(e.msrc=s.currentSrc||s.src,e.alt=s.getAttribute("alt")),(i.dataset.pswpCropped||i.dataset.cropped)&&(e.thumbCropped=!0)}return this.applyFilters("domItemData",e,t,i),e}}function getViewportSize(t,e){if(t.getViewportSizeFn){const i=t.getViewportSizeFn(t,e);if(i)return i}return{x:document.documentElement.clientWidth,y:window.innerHeight}}function parsePaddingOption(t,e,i){let s;if(e.paddingFn)s=e.paddingFn(i)[t];else if(e.padding)s=e.padding[t];else{const i="padding"+t[0].toUpperCase()+t.slice(1);e[i]&&(s=e[i])}return s||0}function getPanAreaSize(t,e){return{x:e.x-parsePaddingOption("left",t,e)-parsePaddingOption("right",t,e),y:e.y-parsePaddingOption("top",t,e)-parsePaddingOption("bottom",t,e)}}const MAX_IMAGE_WIDTH=4e3;class ZoomLevel{constructor(t,e,i,s){this.pswp=s,this.options=t,this.itemData=e,this.index=i}update(t,e,i){this.elementSize={x:t,y:e},this.panAreaSize=i;const s=this.panAreaSize.x/this.elementSize.x,n=this.panAreaSize.y/this.elementSize.y;this.fit=Math.min(1,s<n?s:n),this.fill=Math.min(1,s>n?s:n),this.vFill=Math.min(1,n),this.initial=this._getInitial(),this.secondary=this._getSecondary(),this.max=Math.max(this.initial,this.secondary,this._getMax()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}_parseZoomLevelOption(t){const e=this.options[t+"ZoomLevel"];if(e)return"function"==typeof e?e(this):"fill"===e?this.fill:"fit"===e?this.fit:Number(e)}_getSecondary(){let t=this._parseZoomLevelOption("secondary");return t||((t=Math.min(1,3*this.fit))*this.elementSize.x>MAX_IMAGE_WIDTH&&(t=MAX_IMAGE_WIDTH/this.elementSize.x),t)}_getInitial(){return this._parseZoomLevelOption("initial")||this.fit}_getMax(){const t=this._parseZoomLevelOption("max");return t||Math.max(1,4*this.fit)}}function getKey(t,e){return t&&t.src?t.src+"_"+e:e}function lazyLoadData(t,e,i){const s=e.createContentFromData(t);if(!s||!s.lazyLoad)return;s.key=getKey(t,i);const{options:n}=e,o=getPanAreaSize(n,e.viewportSize||getViewportSize(n)),r=new ZoomLevel(n,t,-1);return r.update(s.width,s.height,o),s.lazyLoad(),s.setDisplayedSize(Math.ceil(s.width*r.initial),Math.ceil(s.height*r.initial)),s}function lazyLoadSlide(t,e){const i=e.getItemData(t);if(!e.dispatch("lazyLoadSlide",{index:t,itemData:i}).defaultPrevented)return lazyLoadData(i,e,t)}class PhotoSwipeLightbox extends PhotoSwipeBase{constructor(t){super(),this.options=t||{},this._uid=0}init(){this.onThumbnailsClick=this.onThumbnailsClick.bind(this),getElementsFromOption(this.options.gallery,this.options.gallerySelector).forEach(t=>{t.addEventListener("click",this.onThumbnailsClick,!1)})}onThumbnailsClick(t){if(specialKeyUsed(t)||window.pswp||!1===window.navigator.onLine)return;let e={x:t.clientX,y:t.clientY};e.x||e.y||(e=null);const i=this.getClickedIndex(t),s={gallery:t.currentTarget};i>=0&&(t.preventDefault(),this.loadAndOpen(i,s,e))}getClickedIndex(t){if(this.options.getClickedIndexFn)return this.options.getClickedIndexFn.call(this,t);const e=t.target,i=getElementsFromOption(this.options.children,this.options.childSelector,t.currentTarget).findIndex(t=>t===e||t.contains(e));return-1!==i?i:this.options.children||this.options.childSelector?-1:0}loadAndOpen(t,e,i){return!window.pswp&&(this.options.index=t,this.options.initialPointerPos=i,this.shouldOpen=!0,this.preload(t,e),!0)}preload(t,e){const{options:i}=this;e&&(i.dataSource=e);const s=[dynamicImportModule(i.pswpModule)];"function"==typeof i.openPromise&&s.push(i.openPromise()),!1!==i.preloadFirstSlide&&t>=0&&(this._preloadedContent=lazyLoadSlide(t,this));const n=++this._uid;Promise.all(s).then(t=>{if(this.shouldOpen){const e=t[0];this._openPhotoswipe(e,n)}})}_openPhotoswipe(t,e){if(e!==this._uid&&this.shouldOpen)return;if(this.shouldOpen=!1,window.pswp)return;const i="object"==typeof t?new t.default(null,this.options):new t(null,this.options);this.pswp=i,window.pswp=i,Object.keys(this._listeners).forEach(t=>{this._listeners[t].forEach(e=>{i.on(t,e)})}),Object.keys(this._filters).forEach(t=>{this._filters[t].forEach(e=>{i.addFilter(t,e.fn,e.priority)})}),i.contentTypes={...this.contentTypes},this._preloadedContent&&(i.contentLoader.addToCache(this._preloadedContent),this._preloadedContent=null),i.on("destroy",()=>{this.pswp=null,window.pswp=null}),i.init()}destroy(){this.pswp&&this.pswp.close(),this.shouldOpen=!1,this._listeners=null,getElementsFromOption(this.options.gallery,this.options.gallerySelector).forEach(t=>{t.removeEventListener("click",this.onThumbnailsClick,!1)})}}export{Content,ImageContent,PhotoSwipeLightbox as default};